<!DOCTYPE html>
<html lang="en">
<!--
   Demo.html
   
   Copyright 2017 Jessica Switzler <vollyball93@Jessica-Switzlers-MacBook-Pro.local>
   
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 2 of the License, or
   (at your option) any later version.
   
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
   
   You should have received a copy of the GNU General Public License
   along with this program; if not, write to the Free Software
   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
   MA 02110-1301, USA.
   
   
-->

<head>
<meta charset="utf-8" />
<title>untitled</title>
<meta name="generator" content="Geany 1.28" />
</head>
		<style>
			body {  
				margin: 0; 
				background-color: black; 
				}
			canvas { 
				width: 100%; 
				height: 100% 
				}
		</style>
		
<body>
	<script src= "three.js-master/build/three.js"></script>
	<script src= "http://threejs.org/examples/js/controls/OrbitControls.js"></script>
	<script src = "three.js-master/build/OBJLoader.js"></script>
	<script src = "three.js-master/build/Detector.js"></script>
	<script src = "three.js-master/build/CanvasRenderer.js"></script>
	<script src = "three.js-master/build/Projector.js"></script>
	<script src = "three.js-master/build/MTLLoader.js"></script>
	<script>
		
		
	var scene, renderer, camera;
	var controls, box, loader, mtlLoader;
	var targetRotation = 0, targetRotationOnMouseDown = 0;
	var mouseX = 0, mouseXOnMouseDown = 0; 
	var material = new THREE.MeshBasicMaterial({color:"rgb(255,224,189)"});
	var width= window.innerWidth, height = window.innerHeight;
		
		
	init();
	myRender();
	
	function init(){
		//detecting if browser is WebGL compatible 
		if (Detector.webgl){
			
			renderer = new THREE.WebGLRenderer(); ({antialias:true});
		}
		else 
		{
			renderer = new THREE.CanvasRenderer();
		}
		
		//Setting up Camera and Scene
		scene= new THREE.Scene();
		scene.background = new THREE.Color("rgb(250,250,250 )");
		camera= new THREE.PerspectiveCamera(45, width/height, 1, 1000);
		loader = new THREE.OBJLoader();
		renderer.setSize(width, height);
		
		camera.position.z=300;
		camera.up.set(0,5,0);
		
		//adding light
		light = new THREE.AmbientLight(0x404040);
		scene.add(light);
		
		
		var dirLight = new THREE.DirectionalLight( 0x404040 );
		dirLight.position.set( 0, 0, 1 ).normalize();
		scene.add( dirLight );
		
		var dirLight2 = new THREE.DirectionalLight( 0x404040 );
		dirLight2.position.set( 0, 0, -1 ).normalize();
		scene.add(dirLight2);
		
		
		
		var onProgress = function(object){
			if(object.lengthComputable){
				var PercentComplete = object.loaded/ object.total *100;
				console.log("model "+ Math.round(PercentComplete,2) + "% loaded");
			}
		};
		var onProgressMtl = function(object){
			if(object.lengthComputable){
				var PercentComplete = object.loaded/ object.total *100;
				console.log("material " + Math.round(PercentComplete,2) + "% loaded");
			}
		};
		var onError = function(){
			console.log("error loading model");
		};
		
		mtlLoader = new THREE.MTLLoader();
		mtlLoader.load("MaleModel.mtl", function(materials) {
			
			materials.preload(); 
			
			loader.setMaterials(materials);
			loader.load("MaleModel.obj", function(object) {
				/*object.traverse( function (child) {
					if (child instanceof THREE.Mesh){
						child.material = materials;
					}
				});*/
				object.position.y = -95;
				scene.add(object);
			}, onProgress, onError);},onProgressMtl, onError);
		
		
		document.addEventListener( 'mousedown', onDocumentMouseDown, false );
		document.addEventListener( 'touchstart', onDocumentTouchStart, false );
		document.addEventListener( 'touchmove', onDocumentTouchMove, false );
		
		document.body.appendChild(renderer.domElement);
		window.addEventListener( 'resize', onWindowResize, false );
		
		
	}
	
	function onDocumentMouseDown() {
		event.preventDefault();
		console.log("mouse down");
		document.addEventListener( 'mousemove', onDocumentMouseMove, false);
		document.addEventListener( 'mouseup', onDocumentMouseUp, false);
		document.addEventListener( 'mouseout', onDocumentMouseOut, false);
		
		mouseXOnMouseDown = event.clientX - (width/2);
		console.log(mouseXOnMouseDown);
		targetRotationOnMouseDown = targetRotation;
		
	}
	
	function onDocumentMouseMove() {
		
		mouseX = event.clientX - (width/2);
		console.log(mouseX);
		targetRotation = targetRotationOnMouseDown + (mouseX - mouseXOnMouseDown) * .01;
		
	}
	
	function onDocumentMouseUp() {
		console.log("mouse up");
		
		document.removeEventListener( 'mousemove', onDocumentMouseMove, false);
		document.removeEventListener( 'mouseup', onDocumentMouseUp, false);
		document.removeEventListener( 'mouseout', onDocumentMouseOut, false);
		
	}
	
	function onDocumentMouseOut() {
		
		document.removeEventListener( 'mousemove', onDocumentMouseMove, false);
		document.removeEventListener( 'mouseup', onDocumentMouseUp, false);
		document.removeEventListener( 'mouseout', onDocumentMouseOut, false);
		
	}
	
	function onDocumentTouchStart() {
		if(event.touches.length == 1){
			console.log(event.touches.length);
			event.preventdefault();
			mouseXOnMouseDown = event.touches[0].pageX - (width/2);
			targetRotation = targetRotationOnMouseDown + (mouseX - mouseXOnMouseDown) * .01;
		}
	}
	
	function onDocumentTouchMove() {
		if(event.touches.length == 1){
			
			event.preventdefault();
			
			mouseX = event.touches[0].pageX -(width/2);
			targetRotation = targetRotionOnMouseDown + (mouseX - mouseXOnMouseDown) * .01;
			
		}
	}
	
	function onWindowResize() {
		camera.aspect = window.innerWidth / window.innerHeight;
		camera.updateProjectionMatrix();
		renderer.setSize( window.innerWidth, window.innerHeight );
	}
			
	function myRender(){
		scene.rotation.y += targetRotation * .01;
		renderer.render( scene, camera );
		requestAnimationFrame( myRender );
		targetRotation= 0;
	}
</script>
		
</body>

</html>
